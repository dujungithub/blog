# 路由监听守卫

购物车页面  cart  ,

1,首页进入购物车时，购物车页面在用户进入前判断是否登录

2，用户在离开购物车页面时，判断是否保存数据并提交



```
//next方法传true或者不传为默认历史返回，传false为不执行历史回退
```

## beforeRouteEnter

```js
//监听当前页面进入事件
beforeRouteEnter(to, from, next) {
  const token = window.localStorage.getItem("token");
  if(to.name=="Cart" && token && token!="" && token!=undefined && token!=null){
    next(true);
  }else{
    next(false);
    router.push({
      path: "/login",
      query: { redirect: router.currentRoute.fullPath } //从哪个页面跳转
    });
  }
},
```

## beforeRouteLeave

```js
//监听当前页面离开事件
beforeRouteLeave(to, from, next) {
  //next方法传true或者不传为默认历史返回，传false为不执行历史回退
  let _this = this;
  /*_this.layerWhite("请提交"+_this.isLeave,["确定"],function () {
    _this.submitStatusCount();
    next(_this.isLeave);
  })*/
  _this.submitStatusCount();
  next();
}
```

